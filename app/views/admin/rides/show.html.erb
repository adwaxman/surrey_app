<div class="row">
  <div class="col s12">
    <h4>
      Ride number:
      <%= @ride.id %>
    </h4>
  </div>
</div>

<div class="row">
  <div class="col s12">
    <table class="striped">
      <thead>
        <tr>
          <th data-field="date">Date</th>
          <th data-field="time">Time</th>
          <th data-field="member">Member</th>
          <th data-field="location">Pickup Location
          </th>
          <th data-field="destination">Destination
          </th>
          <th data-field="status">Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <%= @ride.pickup_date %>
          </td>
          <td>
            <%= @pickup_time %>
          </td>
          <td>
            <%= @ride.member.fname + " " + @ride.member.lname %>
          </td>
          <td>
            <%= @ride.origin.address_line1 %><br>
            <%= @ride.origin.city %>,
            <%= @ride.origin.state %>,
            <%= @ride.origin.zip %>
          </td>
          <td>
            <%= @ride.destination.name %>
            <br>
            <%= @ride.destination.address_line1 %><br>
            <%= @ride.destination.city %>,
            <%= @ride.destination.state %>,
            <%= @ride.destination.zip %>
          </td>
          <td>
            <%= @ride.status %>
            <% if @ride.status == "scheduled" %>
            <br>
            by
            <%= @ride.assigned_by %>
            <% end %>
            <!-- <a href="#" class="btn"> Cancel</a> -->
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<%= form_tag admin_ride_path, method: :put do %>

<div class="row">
  <div class="col s5 offset-s1">
    <div class="ui-widget">
      <label for="tags" name="driver_full_name">Search Drivers
      </label>
      <input id="tags" name="driver_full_name">
    </div>
  </div>
  <div class="s3">
    <%= submit_tag "Assign Driver", class: "btn" %>
  </div>
</div>

<% end %>

<h4>Matched Drivers</h4>
<div class="row">
  <div class="col s12">
    <ul class="collapsible" data-collapsible="expandable">
      <%  @matched_drivers.each do |driver|  %>
      <li>
        <div class="collapsible-header">
          <%= driver.fname + " " + driver.lname %>
        </div>
        <div class="collapsible-body">
          <div class="row">
            <div class="col s3">
              <%= driver.email %>
            </div>
            <% if driver.phone %>
            <div class="col s3">
              Home:
              <%= driver.phone %>
            </div>
            <% end %>
            <% if driver.cell %>
            <div class="col s3">
              Cell:
              <%= driver.cell %>
            </div>
            <% if driver.private %>

            <div class="col s3">
              Private
            </div>
            <% end %>
            <% if !driver.private %>
            <div class="col s3">
              Volunteer
            </div>
            <% end %>
            <% end %>
          </div>
          <div class="row">
            <div class="col s12">
              <% if driver.outreaches.where(ride_id: @ride.id).first %>
              <table class="striped">
                <thead>
                  <tr>
                    <th data-field="date">Date</th>
                    <th data-field="contact-method">Contact Method</th>
                    <th data-field="result">Result
                    </th>
                    <th data-field="admin">Who outreached?
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <% driver.outreaches.where(ride_id: @ride.id).each do |outreach| %>
                  <tr>
                    <td>
                      <%= outreach.created_at %></td>
                    <td><%=outreach.contact_method%></td>
                    <td>
                      <%=outreach.result  %>
                    </td>
                    <td>
                      <%=outreach.admin.fname  %>
                    </td>
                  </tr>

                  <% end %>
                </tbody>
              </table>
              <% end %>
              <%= form_tag new_admin_outreach_path, method: :get  do %>
              <%= hidden_field_tag :ride_id, value=@ride.id %>
              <%= hidden_field_tag :driver_id, value=driver.id %>
              <%= submit_tag "add outreach", class: "btn" %>
              <% end %>

            </div>
          </div>
        </div>
      </li>
      <% end %>
    </ul>

  </div>
</div>

<div class="ui-widget">
  <label for="tags">All Drivers:
  </label>
  <input id="tags">
</div>

<script>
  $(function () {
    var availableTags = [];
    <% @arr_of_drivers.each do |driver| %>
    availableTags.push('<%= driver %>');
    <% end %>

    $("#tags").autocomplete({source: availableTags});
  });
</script>
